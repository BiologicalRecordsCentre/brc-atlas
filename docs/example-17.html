<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>BRC Atlas Library example 16</title>
  <style>

  </style>
</head>
<body style="width: 100vw; height: 100vh; margin: 0; padding: 0">

  <div id="map" style="width: 100%; height: 90%;"></div>
  <div style="height: 10%;">
    <div style="height: 5px"></div>
    <div class="slidecontainer">
      <input type="range" min="1" max="52" value="1" class="slider" oninput="displayTest(this.value)" style="margin: 0; padding: 0"></input>
    </div>
    <div id="weekNo"></div>
  </div>

  <!--European examples CSS-->
  <link rel="stylesheet" type="text/css" href="./example-europe.css">

  <!--Proj4 JS required exernal dependency of BRC Atlas library for European stuff-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.9.0/proj4.js"></script>

  <!--D3 JS required exernal dependency of BRC Atlas library-->
  <script src="https://d3js.org/d3.v7.min.js"></script>

  <!--BRC Atlas library JS and CSS-->
  <script src="./../dist/brcatlas_e.umd.js"></script>
  <link rel="stylesheet" type="text/css" href="./../dist/brcatlas_e.umd.css">

  <script>
    loadTest('./es-painted-ladies-5yr-20230627-ebms.csv')

    var map = brcatlas_e.eSvgMap({
      selector: "#map",
      mapBB: [1000000, 800000, 6000000, 5500000], // [minx, miny, maxx, maxy]
      expand: false
    })

    function loadTest(file) {
      d3.csv(file, d => {
        // Data from ES is event.week, event.year, location.point
        // Convert to week, year, lat, lon
        return {
          year: Number(d['event.year'].replace(',','')),
          week: Number(d['event.week']),
          lat: Number(d['location.point'].split(',')[0]),
          lon: Number(d['location.point'].split(',')[1])
        }
      }).then(data => {
        map.loadData(data)
      })
    }

    function displayTest(e) {
      //console.log(e)
      map.mapData(Number(e))
      d3.select("#weekNo").text(map.getWeekDates(Number(e)))
    }

  </script>
</body>
</html>