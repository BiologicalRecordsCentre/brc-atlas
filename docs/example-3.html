<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>BRC Atlas Library example 3</title>
</head>
<body>
  <div class="content">
    <h1>Using the BRC Atlas Library</h1>
    <p>
      Explore the source of this page and examine the code comments to see how it works.
      Included on this page:
      <ul>
        <li>Creating an atlas map for a region not included in standard assets</li>
        <li>Overriding the 'transOptsSel' property</li>
      </ul>
    </p>
    <h2>Show an Irish distribution map from a CSV file</h2>
    <div id="map"></div>
    <p>
      This example demonstrates creation of an atlas map for a region
      of the British Ilse for which boundary, grid and transformation
      information does not exist as a standard asset in the library.
      In this case, we are displaying a hectad map for Ireland and
      the map is shown on the Irish projection.
    </p>
  </div>
  <!--Page CSS-->
  <link rel="stylesheet" href="example.css" />

  <!--D3 JS required exernal dependency of BRC Atlas library-->
  <script src="https://d3js.org/d3.v7.min.js"></script>

  <!--BRC Atlas library JS and CSS
  Here we get the resources in this package-->
  <script src="./../dist/brcatlas.umd.js"></script>
  <link rel="stylesheet" type="text/css" href="./../dist/brcatlas.umd.css">
  <!--But you can get them from the CDNs as shown below-->
  <!-- <script src="https://cdn.jsdelivr.net/gh/biologicalrecordscentre/brc-atlas@latest/dist/brcatlas.umd.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/biologicalrecordscentre/brc-atlas@latest/dist/brcatlas.umd.css"> -->

  <script>
    /* 
    The BRC SVG map comes with a pre-defined set of transformation objects which specify
    the boundaries of map areas (and optionally insets), but these can be supplemented 
    or overriden with ones we define ourselves. 

    'transOptsKey' specifies the key of the transformation option that is to be selected from 
    transformation option objects defined by 'transOptsSel'.
    
    'transOptsSel' has one or more properties corresponding to transformation option objects.
    In this case only a single transformation is defined. The bounds specify a suitable bounding 
    box for the island of Ireland which must use coordinates in the same projection used
    for the geojson files used to define the boundary and/or grids. In this case we are using
    data projected in the Irish Grid TM75 (EPSG code 29903).
    
    'boundaryGjson' indicates a geoJson file which specifies the geographical boundary of 
    the island of Ireland. This is projected in the Irish Grid system (EPSG code 29903).
    
    'gridGjson' indicates a geoJson file which specifies some grid lines for the island 
    of Ireland - 100 km grid in this case. This is projected in the Irish Grid system
    (EPSG code 29903).

    'proj' this is used to specify the projection that will be used to render the atlas 'dots'. 
    It requires a two letter code corresponding one of the projections known to the BRC Atlas 
    library ('gb', 'ir' or 'ci'). Here, of course, we use 'ir' corresponding to the Irish Grid System.
    */
    const map = brcatlas.svgMap({
      selector: "#map",
      mapTypesKey: 'Standard hectad',
      transOptsKey: 'Ire1',
      transOptsSel: {
        Ire1: {
          id: 'Ire1',
          caption: 'Island of Ireland',
          bounds: {
            xmin: 18000,
            ymin: 12000,
            xmax: 380000,
            ymax: 470000
          },
        },
      },
      boundaryGjson: './data/ireland-29903.geojson',
      gridGjson: './data/ireland-grid-29903.geojson',
      proj: "ir"
    })
    /*
    We use 'map.setIdentfier' to identify some data from a CSV file that contains
    Irish hectad grid references. We are using the standard hectad data accessor 
    function 'Standard hectad'. Finally we draw the map with 'map.redrawMap'.
    */
    map.setIdentfier('./data/example-irish-hectads-1.csv')
    map.redrawMap()
  </script>
</body>
</html>